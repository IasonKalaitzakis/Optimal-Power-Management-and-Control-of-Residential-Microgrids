The adoption of smart energy management systems at demand and distribution levels of the grid is mandated by the ever-increasing presence of smart grids.

In this dissertation, a smart Home Energy Management System (HEMS) that reduces prosumers' daily energy costs and offers the grid ancillary services is proposed.

Photovoltaic (PV) systems, Electric Vehicles (EV), Energy Storage Systems (ESS), flexible and critical loads, and a Multi-Port Converter (MPC) that connects the aforementioned modules with the power grid make up the residential prosumer residence. 

Optimal power management problem is solved using the Particle Swarm Optimization (PSO) method. 

The HEMS also features the ability to function independently when the residential microgrid is disconnected from the main grid. 

Additionally, the designed system can support grid frequency while taking into account the operational flexibility of the controlled power sources and loads. 

The use of k-means clustering and feed-forward neural networks in a load demand forecasting system is also proposed. 

The results obtained by the proposed system demonstrate that the HEMS minimizes the residential prosumer's operating costs, supports system frequency optimally, satisfies all operational requirements of the controlled system, and maintains the operational flexibility of all cooperating power components at the highest level.
